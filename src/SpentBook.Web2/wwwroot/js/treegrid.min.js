(function(n){var t={initTree:function(t){var i=n.extend({},this.treegrid.defaults,t);return this.each(function(){var t=n(this);t.treegrid("setTreeContainer",n(this));t.treegrid("setSettings",i);i.getRootNodes.apply(this,[n(this)]).treegrid("initNode",i);t.treegrid("getRootNodes").treegrid("render")})},initNode:function(t){return this.each(function(){var i=n(this);i.treegrid("setTreeContainer",t.getTreeGridContainer.apply(this));i.treegrid("getChildNodes").treegrid("initNode",t);i.treegrid("initExpander").treegrid("initIndent").treegrid("initEvents").treegrid("initState").treegrid("initChangeEvent").treegrid("initSettingsEvents")})},initChangeEvent:function(){var t=n(this);t.on("change",function(){var t=n(this);t.treegrid("render");t.treegrid("getSetting","saveState")&&t.treegrid("saveState")});return t},initEvents:function(){var t=n(this);t.on("collapse",function(){var t=n(this);t.removeClass("treegrid-expanded");t.addClass("treegrid-collapsed")});t.on("expand",function(){var t=n(this);t.removeClass("treegrid-collapsed");t.addClass("treegrid-expanded")});return t},initSettingsEvents:function(){var t=n(this);t.on("change",function(){var t=n(this);typeof t.treegrid("getSetting","onChange")=="function"&&t.treegrid("getSetting","onChange").apply(t)});t.on("collapse",function(){var t=n(this);typeof t.treegrid("getSetting","onCollapse")=="function"&&t.treegrid("getSetting","onCollapse").apply(t)});t.on("expand",function(){var t=n(this);typeof t.treegrid("getSetting","onExpand")=="function"&&t.treegrid("getSetting","onExpand").apply(t)});return t},initExpander:function(){var t=n(this),r=t.find("td").get(t.treegrid("getSetting","treeColumn")),u=t.treegrid("getSetting","expanderTemplate"),i=t.treegrid("getSetting","getExpander").apply(this);return i&&i.remove(),n(u).prependTo(r).click(function(){n(n(this).closest("tr")).treegrid("toggle")}),t},initIndent:function(){var t=n(this),i;t.find(".treegrid-indent").remove();var r=t.treegrid("getSetting","indentTemplate"),u=t.find(".treegrid-expander"),f=t.treegrid("getDepth");for(i=0;i<f;i++)n(r).insertBefore(u);return t},initState:function(){var t=n(this);return t.treegrid("getSetting","saveState")&&!t.treegrid("isFirstInit")?t.treegrid("restoreState"):t.treegrid("getSetting","initialState")==="expanded"?t.treegrid("expand"):t.treegrid("collapse"),t},isFirstInit:function(){var t=n(this).treegrid("getTreeContainer");return t.data("first_init")===undefined&&t.data("first_init",n.cookie(t.treegrid("getSetting","saveStateName"))===undefined),t.data("first_init")},saveState:function(){var t=n(this);if(t.treegrid("getSetting","saveStateMethod")==="cookie"){var u=n.cookie(t.treegrid("getSetting","saveStateName"))||"",i=u===""?[]:u.split(","),r=t.treegrid("getNodeId");t.treegrid("isExpanded")?n.inArray(r,i)===-1&&i.push(r):t.treegrid("isCollapsed")&&n.inArray(r,i)!==-1&&i.splice(n.inArray(r,i),1);n.cookie(t.treegrid("getSetting","saveStateName"),i.join(","))}return t},restoreState:function(){var t=n(this),i;return t.treegrid("getSetting","saveStateMethod")==="cookie"&&(i=n.cookie(t.treegrid("getSetting","saveStateName")).split(","),n.inArray(t.treegrid("getNodeId"),i)!==-1?t.treegrid("expand"):t.treegrid("collapse")),t},getSetting:function(t){return n(this).treegrid("getTreeContainer")?n(this).treegrid("getTreeContainer").data("settings")[t]:null},setSettings:function(t){n(this).treegrid("getTreeContainer").data("settings",t)},getTreeContainer:function(){return n(this).data("treegrid")},setTreeContainer:function(t){return n(this).data("treegrid",t)},getRootNodes:function(){return n(this).treegrid("getSetting","getRootNodes").apply(this,[n(this).treegrid("getTreeContainer")])},getAllNodes:function(){return n(this).treegrid("getSetting","getAllNodes").apply(this,[n(this).treegrid("getTreeContainer")])},isNode:function(){return n(this).treegrid("getNodeId")!==null},getNodeId:function(){return n(this).treegrid("getSetting","getNodeId")===null?null:n(this).treegrid("getSetting","getNodeId").apply(this)},getParentNodeId:function(){return n(this).treegrid("getSetting","getParentNodeId").apply(this)},getParentNode:function(){return n(this).treegrid("getParentNodeId")===null?null:n(this).treegrid("getSetting","getNodeById").apply(this,[n(this).treegrid("getParentNodeId"),n(this).treegrid("getTreeContainer")])},getChildNodes:function(){return n(this).treegrid("getSetting","getChildNodes").apply(this,[n(this).treegrid("getNodeId"),n(this).treegrid("getTreeContainer")])},getDepth:function(){return n(this).treegrid("getParentNode")===null?0:n(this).treegrid("getParentNode").treegrid("getDepth")+1},isRoot:function(){return n(this).treegrid("getDepth")===0},isLeaf:function(){return n(this).treegrid("getChildNodes").length===0},isLast:function(){if(n(this).treegrid("isNode")){var t=n(this).treegrid("getParentNode");if(t===null){if(n(this).treegrid("getNodeId")===n(this).treegrid("getRootNodes").last().treegrid("getNodeId"))return!0}else if(n(this).treegrid("getNodeId")===t.treegrid("getChildNodes").last().treegrid("getNodeId"))return!0}return!1},isFirst:function(){if(n(this).treegrid("isNode")){var t=n(this).treegrid("getParentNode");if(t===null){if(n(this).treegrid("getNodeId")===n(this).treegrid("getRootNodes").first().treegrid("getNodeId"))return!0}else if(n(this).treegrid("getNodeId")===t.treegrid("getChildNodes").first().treegrid("getNodeId"))return!0}return!1},isExpanded:function(){return n(this).hasClass("treegrid-expanded")},isCollapsed:function(){return n(this).hasClass("treegrid-collapsed")},isOneOfParentsCollapsed:function(){var t=n(this);return t.treegrid("isRoot")?!1:t.treegrid("getParentNode").treegrid("isCollapsed")?!0:t.treegrid("getParentNode").treegrid("isOneOfParentsCollapsed")},expand:function(){return!this.treegrid("isLeaf")&&!this.treegrid("isExpanded")?(this.trigger("expand"),this.trigger("change"),this):this},expandAll:function(){var t=n(this);return t.treegrid("getRootNodes").treegrid("expandRecursive"),t},expandRecursive:function(){return n(this).each(function(){var t=n(this);t.treegrid("expand");t.treegrid("isLeaf")||t.treegrid("getChildNodes").treegrid("expandRecursive")})},collapse:function(){return n(this).each(function(){var t=n(this);t.treegrid("isLeaf")||t.treegrid("isCollapsed")||(t.trigger("collapse"),t.trigger("change"))})},collapseAll:function(){var t=n(this);return t.treegrid("getRootNodes").treegrid("collapseRecursive"),t},collapseRecursive:function(){return n(this).each(function(){var t=n(this);t.treegrid("collapse");t.treegrid("isLeaf")||t.treegrid("getChildNodes").treegrid("collapseRecursive")})},toggle:function(){var t=n(this);return t.treegrid("isExpanded")?t.treegrid("collapse"):t.treegrid("expand"),t},render:function(){return n(this).each(function(){var t=n(this);t.treegrid("isOneOfParentsCollapsed")?t.hide():t.show();t.treegrid("isLeaf")||(t.treegrid("renderExpander"),t.treegrid("getChildNodes").treegrid("render"))})},renderExpander:function(){return n(this).each(function(){var t=n(this),i=t.treegrid("getSetting","getExpander").apply(this);i?t.treegrid("isCollapsed")?(i.removeClass(t.treegrid("getSetting","expanderExpandedClass")),i.addClass(t.treegrid("getSetting","expanderCollapsedClass"))):(i.removeClass(t.treegrid("getSetting","expanderCollapsedClass")),i.addClass(t.treegrid("getSetting","expanderExpandedClass"))):(t.treegrid("initExpander"),t.treegrid("renderExpander"))})}};n.fn.treegrid=function(i){if(t[i])return t[i].apply(this,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error("Method with name "+i+" does not exists for jQuery.treegrid");else return t.initTree.apply(this,arguments)};n.fn.treegrid.defaults={initialState:"expanded",saveState:!1,saveStateMethod:"cookie",saveStateName:"tree-grid-state",expanderTemplate:'<span class="treegrid-expander"><\/span>',indentTemplate:'<span class="treegrid-indent"><\/span>',expanderExpandedClass:"treegrid-expander-expanded",expanderCollapsedClass:"treegrid-expander-collapsed",treeColumn:0,getExpander:function(){return n(this).find(".treegrid-expander")},getNodeId:function(){var t=/treegrid-([A-Za-z0-9_-]+)/;return t.test(n(this).attr("class"))?t.exec(n(this).attr("class"))[1]:null},getParentNodeId:function(){var t=/treegrid-parent-([A-Za-z0-9_-]+)/;return t.test(n(this).attr("class"))?t.exec(n(this).attr("class"))[1]:null},getNodeById:function(n,t){var i="treegrid-"+n;return t.find("tr."+i)},getChildNodes:function(n,t){var i="treegrid-parent-"+n;return t.find("tr."+i)},getTreeGridContainer:function(){return n(this).closest("table")},getRootNodes:function(t){var i=n.grep(t.find("tr"),function(t){var i=n(t).attr("class");return/treegrid-([A-Za-z0-9_-]+)/.test(i)&&!/treegrid-parent-([A-Za-z0-9_-]+)/.test(i)});return n(i)},getAllNodes:function(t){var i=n.grep(t.find("tr"),function(t){var i=n(t).attr("class");return/treegrid-([A-Za-z0-9_-]+)/.test(i)});return n(i)},onCollapse:null,onExpand:null,onChange:null}})(jQuery);$.extend($.fn.treegrid.defaults,{expanderExpandedClass:"glyphicon glyphicon-chevron-down",expanderCollapsedClass:"glyphicon glyphicon-chevron-right"});